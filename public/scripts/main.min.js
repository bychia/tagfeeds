var dateCooked=function(d){var c=new Date(d);var a=new Date();var b=a-c;if(b<3600000){return Math.round(b/60000)+" minutes ago"}else{if(b<86400000){return Math.round(b/3600000)+" hours ago"}else{if(b<604800000){return Math.round(b/86400000)+" days ago"}else{return c.toLocaleDateString()}}}};var backendURL="http://chrischia.info:3000/newsBing";var TableBox=React.createClass({getInitialState:function(){return{data:undefined}},componentDidMount:function(){this.serverRequest=$.ajax({url:this.props.url,dataType:"json",cache:true,timeout:5000,success:function(a){this.setState({data:a})}.bind(this),error:function(c,a,b){console.error(this.props.url,a,b.toString())}.bind(this)})},componentWillUnmount:function(){this.serverRequest.abort()},render:function(){if(this.state.data==undefined){return(<div>
        </div>)}else{var k=this.state.data.length;var g=[];for(var f=0;f<k;f++){var c=(f==0)?"active":"";var e="carouselIndicatorsKeyId"+f;g.push(<li data-target="#carousel-example-generic" data-slide-to={f} className={c} key={e}></li>)}var a=[];for(var f=0;f<k;f++){var d=(f==0)?"item active":"item";var h="carouselInnerParentDivId"+f;var b="carouselInnerImageId"+f;var l="carouselInnerDivId"+f;var n="carouselInnerNewsBg"+f;var m="carouselInnerBlackOverlay"+f;var j={background:'url("'+this.state.data[f].image+'")'};a.push(<div className={d} key={h}>
            <img src="images/spacer.png" height="100%" width="100%" key={b}/>
            <div key={l}>
              <div id="newsBg" style={j} key={n}/>
              <div id="blackOverlay" key={m}/>
            </div>
          </div>)}return(<div>
          <div id="carousel-example-generic" className="carousel slide" data-ride="carousel"  data-interval="false">
            <ol className='carousel-indicators'>
              {g}
            </ol>
            <div className="carousel-inner" role="listbox">
              {a}
            </div>
          </div>
          <NewsBox data={this.state.data} />
        </div>)}}});var NewsBox=React.createClass({getPreviousData:function(){var a=this.state.index-1;a=(a<0)?this.props.data.length-1:a;this.setState({index:a,currentData:this.props.data[a]})},getNextData:function(){var a=this.state.index+1;a=(a==this.props.data.length)?0:a;this.setState({index:a,currentData:this.props.data[a]})},getInitialState:function(){return{index:0,currentData:this.props.data[0]}},render:function(){return(<div>
      <div id="newsFg">
        <table id="news">
          <colgroup>
            <col width="15px"/>
            <col width="auto"/>
            <col width="15px"/>
          </colgroup>
          <tbody>
            <tr>
              <td></td>
              <td id="logoRow">
                <img src="images/logoTfMed.png"/>
              </td>
              <td></td>
            </tr>
            <tr id="newsSection">
              <td>
                <span className="glyphicon glyphicon-chevron-left glyphicon-padding" aria-hidden="true"></span>
              </td>
              <td id="newsRow">
                <div>
                  <span id="newsTitle">
                    {this.state.currentData.title}
                  </span>
                  <br/>
                  <span id="newsSrc">
                    {this.state.currentData.newsSrc}
                  </span>
                  <span id="newsDate" > - {dateCooked(this.state.currentData.pubDate)}
                  </span>
                  <br/>
                  <span id="newsBody">
                    {this.state.currentData.description}
                  </span>
                  <br/>
                  <span id="apiProvider"><img src="images/brandBing.png"/></span>
                </div>
              </td>
              <td>
                <span className="glyphicon glyphicon-chevron-right glyphicon-padding" aria-hidden="true"></span>
              </td>
            </tr>
          </tbody>
        </table>
      </div>

      <a className="left carousel-control" href="#carousel-example-generic" role="button" data-slide="prev" onClick={this.getPreviousData} />
      <a className="right carousel-control" href="#carousel-example-generic" role="button" data-slide="next" onClick={this.getNextData} />
      </div>)}});ReactDOM.render(<TableBox url={backendURL}/>,document.getElementById("content"));