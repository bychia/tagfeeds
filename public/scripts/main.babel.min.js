"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},NavBox=React.createClass({displayName:"NavBox",getData:function(){var e=getSessionSearchText(),t=void 0==e?[void 0]:e.split(","),a=[],n=0;t.forEach(function(e){a[n++]={search:e}}),this.setState({tagList:a})},removeTag:function(e){for(var t=this.state.tagList,a=0;a<t.length;a++){var n=t[a];n.search===encodeURI(e)&&t.splice(a,1)}this.setState({tagList:t})},componentDidMount:function(){var e=this;e.getData(),$(function(){$("#searchForm").submit(function(){return!1}),$("#searchInput").keypress(function(t){var a=$(this);if(13==t.keyCode){var n=a.val();if(n!=getURLRequestSearchText()?localStorage.setItem("tfRefreshSearch",!0):localStorage.setItem("tfRefreshSearch",!1),isUndefined(history)){var c=window.location.origin;window.location.replace(c+"/"+n)}else{n=isEmpty(n)?"/":n,history.pushState(null,null,n),updateSearchStorage(),e.props.callbackParent(a.val()),a.blur();var r=$("#navbar-toggle");r.attr("class").indexOf("collapsed")==-1&&r.click()}}}),$("#searchInput").mousedown(function(){$("meta[name=viewport]").remove(),$("head").append('<meta name="viewport" content="width=device-width, maximum-scale=1.0, user-scalable=0">')}),$("#searchInput").focusout(function(){$("meta[name=viewport]").remove(),$("head").append('<meta name="viewport" content="width=device-width, initial-scale=1.0">')}),$('.has-clear input[type="text"]').on("input propertychange",function(){var e=$(this),t=Boolean(e.val());e.siblings(".form-control-clear").toggleClass("hidden",!t)}).trigger("propertychange"),$(".form-control-clear").click(function(){$("#searchInput").mousedown(),$(this).siblings('input[type="text"]').val("").trigger("propertychange").focus()})})},render:function(){return React.createElement("nav",{className:"navbar navbar-inverse navbar-fixed-top"},React.createElement("div",{className:"container-fluid"},React.createElement("div",{className:"navbar-header"},React.createElement("a",{className:"navbar-brand",href:"#"},React.createElement("img",{src:assetURL+"/images/brandTf.png"})),React.createElement("button",{id:"navbar-toggle",type:"button",className:"navbar-toggle collapsed","data-toggle":"collapse","data-target":"#navbar","aria-expanded":"false","aria-controls":"navbar"},React.createElement("span",{className:"sr-only"},"Toggle navigation"),React.createElement("span",{className:"icon-bar"}),React.createElement("span",{className:"icon-bar"}),React.createElement("span",{className:"icon-bar"}))),React.createElement("div",{id:"navbar",className:"navbar-collapse collapse","aria-expanded":"false"},React.createElement("ul",{className:"nav navbar-nav navbar-left"},React.createElement("form",{id:"searchForm",className:"navbar-form navbar-left has-feedback has-clear",role:"form",action:"."},React.createElement("div",{className:"form-group"},React.createElement("input",{id:"searchInput",type:"text",name:"search",className:"form-control",placeholder:"Search"}),React.createElement("span",{className:"form-control-clear glyphicon glyphicon-remove-circle form-control-feedback translucent"})),React.createElement("div",{className:"bootstrap-tagsinput",id:"tagCollection"},null!=this.state&&this.state.tagList.map(function(e,t){var a=decodeURI(e.search),n=t+a,c="tag:"+n,r="tagRemove:"+n;if(""!=a)return React.createElement("span",{id:c,key:c,className:"tag label"},a,React.createElement("span",{id:r,key:r,"data-role":"remove",onClick:this.removeTag.bind(this,a)}))},this)))))))}}),MainBox=React.createClass({displayName:"MainBox",getInitialState:function(){return{data:void 0}},fetchNewsFeeds:function(e){var t=e,a=getURLRequestSearchText(),n=getSessionSearchText();getSessionRefreshSearch();isEmpty(e)&&(t=isEmpty(a)?n:a);var c=isEmpty(t)?backendURL:backendURL+"?search="+t;this.serverRequest=$.ajax({url:c,dataType:"json",cache:!0,timeout:5e3,success:function(e){if(e.length>0){if(!isUndefined("undefined"==typeof localStorage?"undefined":_typeof(localStorage)))try{localStorage.setItem("tfData",JSON.stringify(e)),localStorage.setItem("tfLastSaved",(new Date).getTime()),localStorage.setItem("tfSearchText",t),localStorage.setItem("tfRefreshSearch",!1)}catch(e){console.log(e.toString())}this.setState({data:e}),this.getNewsBoxData(),this.getNavBoxData()}else showErrorMsg(t)}.bind(this),error:function(e,t,a){console.log(backendURL,t,a.toString())}.bind(this)})},componentDidMount:function(){var e=(new Date).getTime();if(isOutdated(e))this.fetchNewsFeeds();else{var t=localStorage.getItem("tfData");null!=t&&isJSON(t)?this.setState({data:JSON.parse(t)}):showErrorMsg("")}},componentWillUnmount:function(){this.serverRequest.abort()},getNewsBoxData:function(){this.refs.newsBox.getData()},getNavBoxData:function(){this.refs.navBox.getData()},render:function(){return void 0==this.state.data?React.createElement("div",null,React.createElement(NavBox,{ref:"navBox",callbackParent:this.fetchNewsFeeds})):React.createElement("div",null,React.createElement(NavBox,{ref:"navBox",callbackParent:this.fetchNewsFeeds}),React.createElement("div",{id:"carousel-example-generic",className:"carousel slide","data-ride":"carousel","data-interval":"false"},React.createElement("ol",{className:"carousel-indicators"},this.state.data.map(function(e,t){var a=e.title.length,n=this.getNewsBoxData.bind(this,t),c=0==t?"active":" ",r="carouselIndicatorsKeyId"+a+"_"+t;return React.createElement("li",{"data-target":"#carousel-example-generic",onClick:n,"data-slide-to":t,className:c,key:r})},this)),React.createElement("div",{className:"carousel-inner",role:"listbox"},this.state.data.map(function(e,t){var a=e.title.length,n=a+"_"+t,c=0==t?"item active":"item",r="carouselInnerParentDivId"+n,s="carouselInnerImageId"+n,l="carouselInnerDivId"+n,i="carouselInnerNewsBg"+n,o="carouselInnerBlackOverlay"+n,m={background:'url("'+this.state.data[t].image+'")'};return React.createElement("div",{className:c,key:r},React.createElement("img",{src:assetURL+"/images/spacer.png",height:"100%",width:"100%",key:s}),React.createElement("div",{key:l},React.createElement("div",{id:"newsBg",style:m,key:i}),React.createElement("div",{id:"blackOverlay",key:o})))},this))),React.createElement(NewsBox,{ref:"newsBox",data:this.state.data}))}}),NewsBox=React.createClass({displayName:"NewsBox",getData:function(){var e=$(".carousel").find(".active").index();e==-1&&(e=0),this.setState({index:e,currentData:this.props.data[e]})},getInitialState:function(){return{index:0,currentData:this.props.data[0]}},updateMetaData:function(){$("meta[property='og:type']").attr("content","article"),$('meta[property="og:site_name"]').attr("content",this.state.currentData.newsSrc),$('meta[property="og:title"]').attr("content","TAGfeeds: "+this.state.currentData.title),$('meta[property="og:image"]').attr("content",this.state.currentData.image),$('meta[property="og:url"]').attr("content",frontendURL+"/"+getSessionSearchText()),$('meta[property="og:description"]').attr("content",this.state.currentData.description),$('meta[name="twitter:title"]').attr("content","TAGfeeds: "+this.state.currentData.title),$('meta[name="twitter:description"]').attr("content",this.state.currentData.description),$('meta[name="twitter:image"]').attr("content",this.state.currentData.image)},componentDidMount:function(){var e=this;$(function(){$("body").keydown(function(t){var a=t.which;isSearchInputFocused()||37!=a?isSearchInputFocused()||39!=a||($("#carousel-right").click(),e.getData()):($("#carousel-left").click(),e.getData())})}),e.updateMetaData()},componentDidUpdate:function(){this.updateMetaData()},render:function(){return React.createElement("div",null,React.createElement("div",{id:"newsFg",className:"article"},React.createElement("table",{id:"news"},React.createElement("colgroup",null,React.createElement("col",{className:"table-col"}),React.createElement("col",null),React.createElement("col",{className:"table-col"})),React.createElement("tbody",null,React.createElement("tr",null,React.createElement("td",null),React.createElement("td",{id:"logoRow"},React.createElement("img",{src:assetURL+"/images/logoTfMed.png"})),React.createElement("td",null)),React.createElement("tr",{id:"newsSection"},React.createElement("td",null,React.createElement("span",{className:"glyphicon glyphicon-chevron-left glyphicon-padding","aria-hidden":"true"})),React.createElement("td",{id:"newsRow"},React.createElement("div",null,React.createElement("article",null,React.createElement("span",{id:"newsTitle"},React.createElement("a",{href:this.state.currentData.link,target:"_blank"},this.state.currentData.title)),React.createElement("br",null),React.createElement("span",{id:"newsSrc"},this.state.currentData.newsSrc),React.createElement("span",{id:"newsDate"}," - "+dateCooked(this.state.currentData.pubDate)),React.createElement("br",null),React.createElement("span",{id:"newsBody",className:"article1"},React.createElement("article1",null,this.state.currentData.description))),React.createElement("br",null),React.createElement("span",{id:"apiProvider"},React.createElement("img",{src:assetURL+"/images/brandBing.png"})))),React.createElement("td",null,React.createElement("span",{className:"glyphicon glyphicon-chevron-right glyphicon-padding","aria-hidden":"true"})))))),React.createElement("a",{id:"carousel-left",className:"left carousel-control",href:"#carousel-example-generic",role:"button","data-slide":"prev",onClick:this.getData}),React.createElement("a",{id:"carousel-right",className:"right carousel-control",href:"#carousel-example-generic",role:"button","data-slide":"next",onClick:this.getData}))}});ReactDOM.render(React.createElement(MainBox,{url:backendURL}),document.getElementById("content"));
